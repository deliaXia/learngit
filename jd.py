#coding=utf-8
"""
Created on 2016-5-3
京东vip 京东金融签到
cd /home/PyTest/src | python jd.py
cd /home/PyTest/src ; python jd.py ; python suning.py
/usr/local/python3.5/bin/python3.5 /home/PyTest/src/jd.py
@author: developer
"""
from selenium import webdriver
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.keys import Keys #键盘
#from selenium.webdriver.common.action_chains import ActionChains#左击右击
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.common.by import By
import time

url="https://passport.jd.com/new/login.aspx"
inputs=int(input('1PC签到，2PC店铺签到，3mobile签到，4PC收藏店铺\n'))

#method
def accept_alert(self):
    try:
        WebDriverWait(self,2).until(EC.alert_is_present())  #WebDriverWait(dr, 10)：10秒内每隔500毫秒扫描1次页面变化，当出现指定的元素后结束。
        #alert_is_present判断页面上是否存在alert
        alert=self.switch_to_alert()                        #焦点集中到页面上的一个警告（提示）;获取对话框对象
        alert.accept()                                      #点击“确认”;dismiss() :点击“取消” 
    except Exception: return False
    return True
#PC端登录
def loginfront(backurl=""):
    browser=webdriver.Firefox()
    account="帐号"
    password="密码"                                         #需要操控的浏览器
    #account="帐号"
    #password="密码"
    browser.get(url+(("?ReturnUrl="+backurl) if not backurl=="" else "")) #导航到一个页面
    browser.maximize_window()                                           # 浏览器全屏显示

    time.sleep(1)
    
    if browser.find_element_by_css_selector('.login-tab-r').is_displayed(): #切换导航栏
        browser.find_element_by_css_selector('.login-tab-r').click()
    time.sleep(0.5)
    
    WebDriverWait(browser,5).until(lambda x:x.find_element_by_id("loginname"))
    browser.find_element_by_id("loginname").clear()
    browser.find_element_by_id("loginname").send_keys(account)       #搜索的按钮的id 叫login_usr_id，我要在输入框里输入 account
    browser.find_element_by_id("loginname").send_keys(Keys.TAB)
    time.sleep(2) 
    browser.find_element_by_id("nloginpwd").send_keys(password)
    time.sleep(10) 
    browser.find_element_by_id("loginsubmit").send_keys(Keys.ENTER)
    time.sleep(1)                           #休眠1秒 避免太快没看清浏览器的操作过程，在适当的位置加入time.sleep()有助于减少网络原因造成的脚本执行失败
    return browser

def loginfrontByMob(backurl=""):
    browser=webdriver.Firefox()
    url='https://plogin.m.jd.com/user/login.action'                                         #需要操控的浏览器
    account="18082183235"
    password="thejamy13579"
    #account="13645100230"
    #password="667901h"
    browser.get(url+(("?ReturnUrl="+backurl) if not backurl=="" else "")) #导航到一个页面
    browser.maximize_window()                                           # 浏览器全屏显示

    time.sleep(1)
    
    WebDriverWait(browser,5).until(lambda x:x.find_element_by_id("username"))
    browser.find_element_by_id("username").clear()
    browser.find_element_by_id("username").send_keys(account)       #搜索的按钮的id 叫login_usr_id，我要在输入框里输入 account
    browser.find_element_by_id("username").send_keys(Keys.TAB)
    time.sleep(2) 
    browser.find_element_by_id("password").send_keys(password)
    time.sleep(1) 
    browser.find_element_by_id("loginBtn").send_keys(Keys.ENTER)
    time.sleep(1)                           #休眠1秒 避免太快没看清浏览器的操作过程，在适当的位置加入time.sleep()有助于减少网络原因造成的脚本执行失败
    return browser

def is_element_exist(browser,css):
    s = browser.find_elements_by_css_selector(css_selector=css)
    if len(s) == 0:
        return False
    elif len(s) == 1:
        return True
    else:
        return False
    
def bodycode():
#body code
    if inputs==3:
        browser=loginfrontByMob("https://m.jr.jd.com/spe/qyy/hzq/index.html?usertype=1176#/")#领钢蹦
        time.sleep(5)
        html_list = ['https://home.jdpay.com/my/signIndex'
                     ,'https://home.jdpay.com/my/signIndex?source=JDSC&sid=0033077d3aa8c2ea714c03242fbe3d76'#每日一签
                     ,'https://wqs.jd.com/promote/201712/mwelfare/m.html?sceneval=2&logintag=#/main' #每天抽奖（周得免邮及全品）
                     ,'https://wqs.jd.com/my/coupon/coupon_center_v3_sq.shtml'#微信签到
                     ,'https://bean.m.jd.com/'#领京豆签到
                     ,'https://ljd.m.jd.com/countersign/index.action' #双签领奖励
                     ,'https://fbank.m.jd.com/' #京东流量签到
                     ,'https://wyyl.jd.com/static/page/html/index.html?'#京东小金库签到
                     ,'https://datawallet.jd.com/profile.html' #流量口令 
                     ,'https://sale.jd.com/wq/act/FSGdP4mTojE.html'#京豆抽奖
                     ,'https://gamecenter.m.jd.com/'#游戏京豆
                     ,'https://active.jd.com/2018/VaultPraiseGo/html/index.html'#小金库宝箱
                     ,'https://m.jr.jd.com/zc/drawSystem/hb/index.html?contentParam=100000454&actCode=D7FF36101A'#现金
                     ,'https://m.jr.jd.com/zc/drawSystem/hb/index.html?contentParam=100000410&actCode=79DE8B780DEB9ABACA42FA5011BF82731EAAEA097C14E5DA1FB9AB82C1EA9A7037C18F386CCC529E61F297B845EB50EF'
                     ,'https://m.jr.jd.com/zc/drawSystem/hb/index.html?contentParam=100000437&actCode=528D8063EF'
                     ,'https://m.jr.jd.com/zc/drawSystem/hb/index.html?contentParam=100000489&act=1&actCode=C5C535B176#/'
                     ,'https://m.jr.jd.com/zc/drawSystem/hb/index.html?contentParam=100000478&act=1&actCode=7CAB7FE592'
                     ,'https://pro.m.jd.com/mall/active/3XzDsFSWRTGmhma1fbL5R7UVyjv3/index.html'#流量口令
                     ]
        try:
            for x in html_list:
                browser.get(x)
                time.sleep(10)
        except Exception: 
            browser.quit()  
            return
        
    if inputs==1:      
        browser=loginfront("http://vip.jr.jd.com/?token=sign")
        try:
            #签到
            WebDriverWait(browser,5).until(lambda x:x.find_element_by_css_selector("a.m-qian"))
            browser.find_element_by_css_selector("a.m-qian").click()
            #抽奖
            WebDriverWait(browser,5).until(lambda x:x.find_element_by_css_selector("a#drawAward"))
            browser.find_element_by_css_selector("a#drawAward").click()
            WebDriverWait(browser,5).until(lambda x:x.find_element_by_css_selector("div.begin-btn"))
            browser.find_element_by_css_selector("div.begin-btn").click()
        except Exception: 
            browser.find_element_by_tag_name('body').send_keys(Keys.COMMAND + 'w')
    
        browser.get("https://vip.jd.com/home.html")
        try:
            WebDriverWait(browser,5).until(lambda x:x.find_element_by_id("signIn"))
            browser.find_element_by_id("signIn").click()
            
            #WebDriverWait(browser,5).until(lambda x:x.find_element_by_css_selector(".ui-dialog-close"))
            #browser.find_element_by_css_selector(".ui-dialog-close").click()
            
        except Exception: 
            browser.find_element_by_tag_name('body').send_keys(Keys.COMMAND + 'w')
    
        #京东游戏
        browser.get("https://huan.jd.com")
        try:
            WebDriverWait(browser,5).until(lambda x:x.find_element_by_id("signin-btn"))
            browser.find_element_by_id("signin-btn").click()
        except Exception: 
            browser.find_element_by_tag_name('body').send_keys(Keys.COMMAND + 'w')
    
        #京友邦 京东旗下互动社区
        html_list = ['https://you.jd.com/channel/shouji.html'
                     ]
        try:
            for x in html_list:
                browser.get(x)
                time.sleep(5)
        except Exception: 
            browser.quit()
            return  

    
         
    
    
    #店铺签到 
    if inputs==2:
        browser=loginfront()  
        seller_id_list = ['1000003179','1000078067','1000081124','1000002670','1000003571','1000087367'
                          ,'22705','622959','670392','621554','651524','77222','86174','95513','615369','656188','606079'
                          ,'146935','15668','698472','617783','197251','590119','16953','128188','82059','199457','755250'
                          ,'1000001582'
                          ,'708779','22705','586278','77222','205825','692446','146935','86174','675899','216582','599741','593446','590205','15738'
                          ,'1000005289','1000005754','1000001582','1000001402','1000013741','1000002560','1000075682','1000003112','1000002261'
                          ,'1000003663','1000002668','1000009163','1000000950','1000002688','1000089485','1000013169','1000083981','1000000764'
                          ,'1000077145','1000005186','1000001434','1000001228','1000002670','1000001934','1000003179','1000084032','1000002520'
                          ,'1000002668','1000015942','1000003571','1000075682','1000081124','1000002397','1000077982','1000002261'
                          ,'1000003179','1000001228','1000001582','1000000725','1000003663','1000001934','1000084032','1000002670','1000002520','1000081124'
                          ,'1000002668','1000001582','1000002520','1000075682','1000001228','1000003663','1000003179','1000081124','1000084032','1000005754','1000001934','1000002670']
        #temp_list=list(range(10000,90000))
        try:
            ##店铺签到
            for x in seller_id_list:
                browser.find_element_by_tag_name('body').send_keys(Keys.COMMAND + 't')          #相等与Ctrl+t
                try:
                    browser.get('https://mall.jd.com/shopSign-'+str(x)+'.html')
                    time.sleep(0.1)
                    browser.find_element_by_tag_name('body').send_keys(Keys.COMMAND + 'w')
                    time.sleep(0.2)
                except Exception:
                    #browser.find_element_by_tag_name('body').send_keys(Keys.COMMAND + 'w')
                    #continue 
                    browser.quit()
            #查看淘金币领取记录、数量
            browser.find_element_by_tag_name('body').send_keys(Keys.COMMAND + 't')          #相等与Ctrl+t
            browser.get('https://bean.jd.com/myJingBean/list')
            browser.find_element_by_tag_name('body').send_keys(Keys.COMMAND + 'w')
            time.sleep(5)
        except Exception: 
            browser.quit()
        return
        
    #收藏店铺
    #https://t.jd.com/vender/followVenderList.action批量删除店铺
    #687422要点击两下
    if inputs==4:
        browser=loginfront()
        temp_list =['1000008851','1000002429','1000014704','1000001091','1000007631','1000013173','1000015061','1000008863','1000004691','1000014745'
                    ,'1000004232','1000013061','1000003349','1000003578','1000003743','1000003446','1000002804','1000094078','1000002838','1000086727'
                    ,'1000003199','1000011442','1000002560','1000009163','1000011183','1000077222','1000100548','1000090345','1000098122','1000003796'
                    ,'1000083463','1000003201','1000093630','1000002467','1000085723','1000091591','1000084085','1000002493','1000004381','1000080406'
                    ,'1000081341','1000073662','1000083145','1000015347','1000087386','1000003313','1000002308','1000002921','1000091223','1000075561'
                    ,'1000083263','1000004981','1000073063','1000001098','1000097201','1000002204','1000000921','1000000187','1000000754','1000087395'
                    ,'1000002427','1000089842','1000003550','1000001293','1000002261','1000002257','1000001956','1000092614','1000017325','1000011546'
                    ,'1000003594','1000005675','1000005700','1000075682','1000002452','1000002425','1000002598','1000007924','1000002857','1000001743'
                    ,'1000077145','1000082964','1000075365','1000074586','1000003143','1000001434','1000002350','1000000567','1000001228','1000001582'
                    ,'1000000582','1000001834','1000087324','1000005512','1000072731','1000074605','1000088824','1000003663','1000089521','1000092962'
                    ,'1000081929','1000093234','1000081483','1000086267','1000082162','1000097794','1000092647','1000000276','1000007127','1000015827'
                    ,'1000004373','1000001031','1000077350','1000078682','1000008642','1000097213','1000001789','1000039942','1000002298','1000001202'
                    ,'1000081858','1000090378','1000081604','1000093394','1000013882','1000002587','1000010583','1000011218','1000077545','1000003597'
                    ,'1000079366','1000081562','1000081625','1000082403','1000082488','1000083442','1000083684','1000087228','1000087267','1000090568'
                    ,'1000084163','1000084861','1000085871','1000094005','1000097165','1000098882','1000099322','1000100386','1000100425','1000100430'
                    ,'1000100695','1000100767','1000007541','1000083265','1000092979','1000005711','1000083134','1000083981','1000000764','1000013169'
                    ,'1000007244','1000090366','1000001095','1000001383','1000083224','1000084461','1000000937','1000002241','1000000950','1000001402'
                    ,'1000001414','1000003112','1000000492','1000088981','1000002122','1000000404','1000001953','1000079906','1000000121','1000072370'
                    ,'1000001624','1000081741','1000014501','1000076082','1000080666','1000072528','1000001621','1000091803','1000001254','1000077982'
                    ,'1000074244','1000083914','1000085026','1000001105','1000001243','1000003573','1000001391','1000010845','1000015826','1000003178'
                    ,'33124','183120','667985','602152','77213','210871','704365','114921','69948','608506','646714','209942','35811','146935','95513'
                    ,'66781','186603','661938','110320','50492','39349','125338','150096' ,'57115','43761' ,'35192','648928','53946','612757','640796'
                    ,'199094','656800','617783','667848','745319','149869','209108','212981','202462','71024','217619','216694','19937','100930','19808'
                    ,'633470','123488','217567','606073','137955','133219','63292','50808','698551','693845','58368','609799','654843','722473','749098'
                    ,'51896','107757','628361','711783','153500','661571','685375','81477','46183','99080','46183','217250','726457','682040','582785','55790','681320','638737'
                    ,'117772','605692','697980','728797','639518','54515','181478','673822','717036','593918','677659','22705','205825','72204','120493','624085','652735'
                    ,'605324','613096','101019','755250','606079','663155','694196','23648','678536','744062','547352','73831','753335','191993','121268','132238','60025'
                    ,'85139','132238','60025','85139','129428','120524','120507','119880','108261','111240','110979','106280','112575','112396','104720','101986','100370'
                    ,'85705','80126','81367','69221','64028','52359','50697','42325','41987','31526','27986','25168'
                    ,'1000000331','1000002628','1000000837','1000011209','1000000343','1000005719','1000003157','1000000529','1000000307','1000006131'
                    ,'1000007373','1000000952','1000003367','1000001700','1000001111','1000002241','1000002520','1000002397','1000098782','1000003448'
                    ,'1000001582','1000015942','1000073941','1000001967','1000011324','1000002605','1000084454','1000005305','1000010552','1000098186'
                    ,'1000002392','1000092142','1000011215','1000072323','1000003026','1000001223','1000008321','1000004334','1000003904','1000000907'
                    ,'1000001782','1000014484','1000002500','1000001392','1000003112','1000002688','1000004706','1000001933','1000001342','1000003197'
                    ,'1000002864','1000084954','1000075554','1000082446','1000001238','1000089021','1000085963','1000001316','1000002376','1000083304'
                    ,'1000090710','1000000176','1000072708','1000079864','1000001317','1000005186','1000075442','1000003244','1000004065'
                    ,'747882','584335','747259','122806','761199','57617','149020','661571','137955','217051','718938','654790','119880','151623','620574'
                    ,'150089','664124','709944','139046','685375','123488','612757','640796','107757','153500'
                    ,'1000090147','1000092658','1000092658','1000000567','1000099121','1000002978','1000000314','1000039942','1000001789','1000005719','1000001623'
                    ,'1000004279','1000089682','1000001462','1000001285','1000000725','1000001934','1000000749','1000003542','1000001104','1000085502'
                    ,'1000077045','1000077226','1000077410','1000077436','1000077561', '1000077581', '1000077602', '1000077784', '1000077925','1000080241'#add
                    ,'1000078004', '1000078022', '1000078105', '1000078242', '1000078270', '1000078334', '1000078542','1000086066','1000000934','1000000747','1000086643'
                    ,'1000001167','1000093263','1000079352', '1000079370', '1000079389', '1000079429','1000004207','1000082182','1000004451','1000080004', '1000080045', '1000080122'
                    ,'1000080261','1000080446','1000080605','1000080646','1000080868','1000080881','1000080886','1000081006','1000081026','1000081044'
                    ,'1000081223','1000081229','1000081302','1000081444','1000081446','1000081503','1000081641','1000081761','1000081825','1000081830'
                    ,'1000081876','1000081963','1000082121','1000082145','1000082147','1000082184','1000082221','1000082251'
                    ,'1000083521','1000083643','1000083681','1000083685','1000083761','1000083781','1000083930','1000083945','1000083948','1000083969','1000083970'
                    ,'1000083971','1000083976','1000084006','1000084083','1000084123','1000084141','1000084204','1000084244','1000084282','1000084284','1000084285'
                    ,'1000084310','1000084330','1000084448','1000084453','1000084581','1000084983','1000000742'
                    ,'1000004451','1000001032','1000001048','1000001049','1000001061','1000001064','1000001072','1000001074','1000001089','1000001106','1000001119','1000001123'
                    ,'1000001132','1000001135','1000001139','1000001142','1000001206','1000001212','1000001254','1000001255','1000001262','1000001281','1000001283','1000001290'
                    ,'1000001291','1000001314','1000001325','1000001345','1000001359','1000001373','1000001412','1000001419','1000001465','1000001466','1000001474','1000001485'
                    ,'1000001491','1000001504','1000001509','1000001521','1000001595','1000001603','1000001605','1000001609','1000001612','1000001613','1000001683','1000001717'
                    ,'1000001746','1000001747','1000001750','1000001759','1000001764','1000001774','1000001788','1000001798','1000001830','1000001845','1000001846','1000001859'
                    ,'1000001865','1000001901','1000001906','1000001916','1000001930','1000001931','1000001943','1000001961','1000001978','1000001982','1000001996','1000002002'
                    ,'1000002053','1000002076','1000002141','1000002300','1000002304','1000002307','1000002368','1000002370','1000002402','1000002430','1000002449','1000002465'
                    ,'1000002490','1000002493','1000002497','1000002540','1000002569','1000002570','1000002576','1000002583','1000002586','1000002591','1000002596','1000002614'
                    ,'1000002627','1000002644','1000002670','1000002672','1000002675','1000002676','1000002681','1000002700','1000002707','1000002710','1000002721','1000002725'
                    ,'1000002726','1000002731','1000002772','1000002785','1000002791','1000002794','1000002795','1000002796','1000002806','1000002812','1000002813','1000002815'
                    ,'1000002826','1000002830','1000002833','1000002836','1000002846','1000002852','1000002853','1000002867','1000002971','1000002989','1000002991','1000002994'
		            ,'1000003002','1000003003','1000003005','1000003016','1000003039','1000003044','1000003048','1000003050','1000003051'
                    ,'1000003052','1000003062','1000003063','1000003109','1000003110','1000003111','1000003122','1000003129','1000003168'
                    ,'1000003193','1000003218','1000003219','1000003224','1000003243','1000003283','1000003320','1000003340','1000003353'
                    ,'1000003357','1000003363','1000003424','1000003443','1000003445','1000003450','1000003534','1000003535','1000003536'
                    ,'1000003540','1000003567','1000003571','1000003690','1000003691','1000003747','1000003787','1000003790','1000003795','1000003804','1000003835'
                    ,'1000005042','1000005113','1000005148','1000005289','1000005308','1000005321','1000005363','1000005601','1000005669','1000005735','1000005736'
                    ,'1000005754','1000005762','1000005770','1000005792','1000005826','1000006641','1000006804','1000092208','1000091241','1000087025','1000092529','1000089981','16591'
                    ,'1000085844','1000092494','1000087082','12709','1000099582','11885','36677','122485','67655','761208','75416','735870','1000003187','3187'
                    ,'1000003205','3205','1000003262','3262','1000003263','3263','1000003305','3305','1000003537','3537','1000003550','3550'
                    ,'1000003556','3556','1000003594','3594','1000003788','3788','1000003885','3885','1000003904','3904','1000003981','3981','1000002520','1000001582','1000001934'
                    ,'1000003112','1000002241','1000075682','1000003179','1000002688','1000001228','1000003663','1000081124','1000002397','1000005762','1000074543','60096','1000001267'
                    ,'1000086283','1000002371','1000078089','1000002453','1000001187','630205','681414','135380','1000097162','1000086125','1000097176','1000002560','1000000830'
                    ,'1000097383','1000001606','1000001190','1000098782','1000010285','1000012185 ','1000002397','1000091241','1000001140','1000002122','1000090366','1000003244'
                    ,'743139','1000004333','214530','68771','1000094541','110518','1000001620','117532','1000086583','121267','19895','45332','67905','638737','188167','146237'
                    ,'670392','169416','121267','216694','774068','680915','146510','68977','703324','19617'
		    ]
        #temp_lists =list(range(3000,4000))
        temp_lists1 =['1000004691','1000003349','1000002204','1000000921','1000002857','1000001743','1000003143','1000000582'
                ,'1000003663','1000097213','1000013882','661938','150096','216694','50808','605324','1000001462','1000003542'
                ,'1000078004','1000086643','1000004451','1000080881','1000001504','1000001746','1000002370','1000002402'
                ,'1000002627','1000002707','1000002794','1000003111','1000003353','1000005042','1000005289','1000005308'
                ,'1000005754','122485','35192','617783','50808','722473','638737','181478','104720','735870','743139','1000004333','214530'
                ,'68771','1000094541','110518','1000001620','117532','1000086583','121267','19895','45332','67905','638737','188167','146237'
                ,'670392','169416','121267','216694','774068','680915','146510','68977','703324','19617','104720','169416','752861','96752','12987','146510'
                ,'60096','718938','120188','150089','186603','738967','743139','89111','121480','65898','146935','612757'
                ,'714730','34181','71432','56190','99017','764016','751013','46299','740365','752101','20961','18574','743633','123488','114168','724433','681414','779146'
                ,'88958','104732','71221','50808','742771','20250','738982','753697','726532','134114','25662','47930','37794','76488','20606','54498'
                ,'746355','640796','648928','120201','170040','663155','47578','743100','217250','67876','69804','66736','68241','68035','64304','68145','64814','584610']
        temp_lists = ['120280','73011','41106','1000001228','50157','34653','37727','48859','17153'
,'60191','70508','20337','44704','35324','29859','75131','35059','191261','14122','40868','29703'
,'53883','32631','70026','28496','16279','138089','86839','32649','26159','72074','13726','47601'
,'95779','21168','17336','650185','40722','54893','29668','15084','587421','85532','32933','28289'
,'61710','59949','40451','39834','26366','17529','92707','98238','59699','142357','28000','44787'
,'22837','70463','42973','91327','42007','30399','75802','174776','98716','50947','38797','187928'
,'62883','16501','68254','20751','210084','44851','163903','81500','37640','76581','50452','647095'
,'15241','135086','684382','81407','20406','153760','58071','62870','56640','37600','165322','59176'
,'89024','42358','11590','71126','38195','33436','90055','30356','13132','53557','147275','611849'
,'190143','39822','24959','31231','67312','69045','92555','95387','147652','155250','40161','20790'
,'36485','547213','49924','11339','102404','97310','104706','66928','12448','89909','547499','30158'
,'147154','83957','90127','43383','79631','86810','80456','86118','44183','53576','89460','26157'
,'67311','126392','1000004981','26275','61001','189309','56823','41998','63746','37774','34100'
,'139801','95750','42247','46808','738967','54056','72927','24402','63807','745070','764016','50808']
        
        L=[]
        try:
            for y in temp_list:
                browser.find_element_by_tag_name('body').send_keys(Keys.COMMAND + 't')          #相等与Ctrl+t
                try:
                    browser.get('https://mall.jd.com/index-'+str(y)+'.html')
                    time.sleep(0.5)
                    if is_element_exist(browser,"a.d-btn"):
                        browser.find_element_by_css_selector("a.d-btn").click()
                        #L.append('100000'+str(y))
                        L.append(str(y))
                        browser.find_element_by_tag_name('body').send_keys(Keys.COMMAND + 'w')
                except Exception: 
                    browser.find_element_by_tag_name('body').send_keys(Keys.COMMAND + 'w')
                    browser.quit()
            print(L)
        except Exception: 
            browser.quit()
        return   
        
    
bodycode()

